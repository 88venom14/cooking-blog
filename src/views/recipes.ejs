<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ö—É–ª–∏–Ω–∞—Ä–Ω—ã–π –±–ª–æ–≥</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <%- include('partials/header', { currentPage: currentPage }) %>

  <div class="page">
    <h1><%= pageTitle || "–í—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã" %></h1>


    <form method="GET" action="<%= basePath || '/recipes' %>" class="filter-bar">


      <select name="difficulty">
        <option value="">--–°–ª–æ–∂–Ω–æ—Å—Ç—å--</option>
        <option value="easy" <%= currentDifficulty === 'easy' ? 'selected' : '' %>>–ü—Ä–æ—Å—Ç—ã–µ</option>
        <option value="medium" <%= currentDifficulty === 'medium' ? 'selected' : '' %>>–°—Ä–µ–¥–Ω–∏–µ</option>
        <option value="hard" <%= currentDifficulty === 'hard' ? 'selected' : '' %>>–°–ª–æ–∂–Ω—ã–µ</option>
      </select>

      <select name="category">
        <option value="">--–ö–∞—Ç–µ–≥–æ—Ä–∏—è--</option>
        <% categories.forEach(cat => { %>
          <option value="<%= cat.id %>" 
            <%= currentCategory == cat.id ? 'selected' : '' %>>
            <%= cat.name %>
          </option>
        <% }) %>
      </select>

      <button type="submit">–§–∏–ª—å—Ç—Ä</button>

    </form>





    <% if (currentPage === 'all') { %>
      <div class="sort-controls">
        <a href="/recipes?sort=date" class="sort-btn <%= currentSort === 'date' ? 'active' : '' %>">
          –ü–æ –¥–∞—Ç–µ
        </a>
        <a href="/recipes?sort=likes" class="sort-btn <%= currentSort === 'likes' ? 'active' : '' %>">
          –ü–æ –ª–∞–π–∫–∞–º
        </a>
      </div>
    <% } %>

    <% if (!recipes || recipes.length === 0) { %>
      <p style="text-align: center; color: #7a6f5f; font-style: italic; margin: 3rem 0;">
        –ü–æ–∫–∞ —á—Ç–æ –∑–¥–µ—Å—å –ø—É—Å—Ç–æ... –°–æ–∑–¥–∞–π —Å–≤–æ–π –ø–µ—Ä–≤—ã–π —Ä–µ—Ü–µ–ø—Ç!
      </p>
    <% } else { %>
      <div class="recipes-grid">
        <% recipes.forEach(recipe => { %>
          <div class="recipe-card">
            <% if (recipe.imageUrl) { %>
              <img src="<%= recipe.imageUrl %>" alt="<%= recipe.title %>" class="recipe-image">
            <% } else { %>
              <div class="recipe-image-placeholder"></div>
            <% } %>

            <div class="recipe-title">
              <a href="/recipes/<%= recipe.id %>">
                <%= recipe.title %>
              </a>
            </div>

            <div class="recipe-meta">
              –ê–≤—Ç–æ—Ä: <%= recipe.author?.username || '–ê–Ω–æ–Ω–∏–º' %> ‚Ä¢ 
              –ö–∞—Ç–µ–≥–æ—Ä–∏—è: <%= recipe.category?.name || '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏' %> ‚Ä¢ 
              –°–ª–æ–∂–Ω–æ—Å—Ç—å: 
              <% if (recipe.difficulty === 'easy') { %>üïäÔ∏è –õ–µ–≥–∫–æ<% } %>
              <% if (recipe.difficulty === 'medium') { %>üïØÔ∏è –°—Ä–µ–¥–Ω–µ<% } %>
              <% if (recipe.difficulty === 'hard') { %>‚öóÔ∏è –°–ª–æ–∂–Ω–æ<% } %>
            </div>

            <div class="recipe-content">
              <%= recipe.content.substring(0, 150) %>...
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>

    <div style="text-align: center; margin: 3rem 0;">
      <a href="/recipes/create">
        <button class="new-recipe-button">+ –ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</button>
      </a>
    </div>
  </div>
</body>
</html>